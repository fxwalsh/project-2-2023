~~~c++
/*
  Sketch generated by the Arduino IoT Cloud Thing "Untitled"
  https://create.arduino.cc/cloud/things/69103dec-b121-4880-ad1c-2c95d7c3f4e8

  Arduino IoT Cloud Variables description

  The following variables are automatically generated and updated when changes are made to the Thing

  - No variables have been created, add cloud variables on the Thing Setup page
    to see them declared here

  Variables which are marked as READ/WRITE in the Cloud Thing will also have functions
  which are called when their values are changed from the Dashboard.
  These functions are generated with the Thing and added at the end of this sketch.
*/

#include "thingProperties.h"
#include <ArduinoHttpClient.h>
#include <ArduinoJson.h>


// Name of the server we want to connect to
const char kHostname[] = "88.80.186.240";
// Path to download (this is the bit after the hostname in the URL
// that you want to download
const char kPath[] = "/prox/DryPlant/iq1372WAGxdXv7bvRWCD_c2Zu_bdHw67rylkACCTXAM";

const char kWeatherPath[] = "/weather";
  StaticJsonDocument<1024> doc;
// Number of milliseconds to wait without receiving any data before we give up
const int kNetworkTimeout = 30 * 1000;
// Number of milliseconds to wait if no data is available before trying again
const int kNetworkDelay = 1000;

WiFiClient client;
HttpClient http(client, kHostname, 3000);


void setup() {
  // Initialize serial and wait for port to open:
  Serial.begin(9600);
  // This delay gives the chance to wait for a Serial Monitor without blocking if none is found
  delay(1500);

  // Defined in thingProperties.h
  initProperties();

  // Connect to Arduino IoT Cloud
  ArduinoCloud.begin(ArduinoIoTPreferredConnection);

  /*
     The following function allows you to obtain more information
     related to the state of network and IoT Cloud connection and errors
     the higher number the more granular information youâ€™ll get.
     The default is 0 (only errors).
     Maximum is 4
  */
  setDebugMessageLevel(2);
  ArduinoCloud.printDebugInfo();
  Serial.println("connecting...");
  //char server[] = "88.80.186.240";
  // if (client.connect(server,3000)) {
  //  Serial.println("connected to server");
  //  client.println("GET /prox/DryPlant/iq1372WAGxdXv7bvRWCD_c2Zu_bdHw67rylkACCTXAM HTTP/1.1");
  //  client.println("Connection: close");
  //
  //  client.println();
  // }
  // else{
  //     Serial.println("connected to notr");
  //   }

  Serial.println("Done");
}

void loop() {
  ArduinoCloud.update();
  int err = 0;

 // err = http.get(kPath);
  Serial.println(err);

///  http.stop();
Serial.println(kWeatherPath);
//err = http.get(kWeatherPath);
getWeather();
// String response = http.responseBody();
// Deserialize the JSON document
//  DeserializationError error = deserializeJson(doc, response);
//  const char* desc = doc["weather"][0]["description"];
//  Serial.println(desc);
//iftttSend();
  delay(10000);
//http.stop();
}

void iftttSend() {
  Serial.println("Alarm triggered !");
  // Connexion au serveur IFTTT
  Serial.println("Starting connection to server...");
  if (client.connect(kHostname,3000)) {
    Serial.println("Connected to server IFTTT, ready to trigger alarm...");
    // Make a HTTP request:
    client.println("GET /prox/DryPlant/iq1372WAGxdXv7bvRWCD_c2Zu_bdHw67rylkACCTXAM HTTP/1.1"); // Replace "XXX" by your own IFTTT key
    client.println();
    Serial.println("IFTTT alarm triggered !");
  }
  else {
    Serial.println("Connection at IFTTT failed");
  }
}

void getWeather() {
     Serial.println("weather triggered !");
  // Connexion au serveur IFTTT
  Serial.println("Starting connection to server...");
  if (client.connect(kHostname,3000)) {
    Serial.println("Connected to server IFTTT, ready to trigger alarm...");
    // Make a HTTP request:
    client.println("GET /weather HTTP/1.1"); // Replace "XXX" by your own IFTTT key
    client.println();
    Serial.println("IFTTT alarm triggered !");
  }
  else {
    Serial.println("Connection at IFTTT failed");
  }
    
     while (client.available()) {
    char c = client.read();
    Serial.print(c);
  }

  // if the server's disconnected, stop the client:
  if (!client.connected()) {
    Serial.println();
    Serial.println("disconnecting from server.");
    client.stop();

  }
      
    
}
~~~

